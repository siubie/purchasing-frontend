<div ng-init=load()>
<h4>Master Barang</h4>
<div class="form-inline">
	<span class="input-group input-group-sm">
		<select class="form-control" ng-model="itemsPerPage" ng-init="itemsPerPage=10" ng-change="currentPage=1">
			<option value="10">10</option>
			<option value="25">25</option>
			<option value="50">50</option>
			<option value="100">100</option>
		</select>
	</span>
	<button class="btn btn-default btn-sm" type="button" ng-click="openCreate()"><span class="glyphicon glyphicon-plus"></span> Tambah</button>
	<button class="btn btn-default btn-sm" type="button" ng-click="load()"><span class="glyphicon glyphicon-refresh"></span> Refresh</button>
	<div class="pull-right">
		<div class="input-group input-group-sm">
			<span class="input-group-addon" ng-show="!search.$"><span class="glyphicon glyphicon-search"></span></span>
			<span class="input-group-addon" ng-show="!!search.$" ng-click="search.$=''"><span class="glyphicon glyphicon-remove"></span></span>
			<input type="text" class="form-control" ng-model="search.$"/>
		</div>
	</div>
</div>
<br/>
<h5 ng-show="!barangs.length">Data Permintaan Barang Kosong</h5>
<div ng-show="!!barangs.length">
	<!-- <div ng-repeat="barang in filtered">{{$index}} : {{barang | json}}</div> -->
	<h5 ng-show="filtered.length==0">Hasil yang Anda Cari Tidak Ditemukan<br/><br/></h5>
	<h5 ng-show="currentPageForm.$invalid&&filtered.length>0">Masukkan Nomor Halaman yang benar<br/><br/></h5>
	<table class="table table-striped table-bordered table-condensed" ng-init="currentPage=1;reverse=false" ng-show="currentPage>0&&currentPage<=maxPage">
		<thead>
			<tr>
				<th style="vertical-align:middle" class="text-center" rowspan="2"><input type="checkbox" ng-model="selectedAll" ng-init="selectedAll=false" ng-change="checkDisplayed()"></th>
				<th class="text-center" ng-click="sort=='kode'?reverse=!reverse:null;sort='kode'">
					<strong>Kode </strong>
					<span ng-show="sort=='kode'&&reverse==true" class="glyphicon glyphicon-triangle-bottom"></span>
					<span ng-show="sort=='kode'&&reverse==false" class="glyphicon glyphicon-triangle-top"></span>
				</th>
				<th class="text-center" ng-click="sort=='kategori'?reverse=!reverse:null;sort='kategori'">
					<strong>Kategori </strong>
					<span ng-show="sort=='kategori'&&reverse==true" class="glyphicon glyphicon-triangle-bottom"></span>
					<span ng-show="sort=='kategori'&&reverse==false" class="glyphicon glyphicon-triangle-top"></span>
				</th>
				<th class="text-center" ng-click="sort=='nama'?reverse=!reverse:null;sort='nama'">
					<strong>Nama </strong>
					<span ng-show="sort=='nama'&&reverse==true" class="glyphicon glyphicon-triangle-bottom"></span>
					<span ng-show="sort=='nama'&&reverse==false" class="glyphicon glyphicon-triangle-top"></span>
				</th>
				<th class="text-center" ng-click="sort=='alias'?reverse=!reverse:null;sort='alias'">
					<strong>Alias </strong>
					<span ng-show="sort=='alias'&&reverse==true" class="glyphicon glyphicon-triangle-bottom"></span>
					<span ng-show="sort=='alias'&&reverse==false" class="glyphicon glyphicon-triangle-top"></span>
				</th>
				<th class="text-center" ng-click="sort=='satuan'?reverse=!reverse:null;sort='satuan'">
					<strong>Satuan </strong>
					<span ng-show="sort=='satuan'&&reverse==true" class="glyphicon glyphicon-triangle-bottom"></span>
					<span ng-show="sort=='satuan'&&reverse==false" class="glyphicon glyphicon-triangle-top"></span>
				</th>
				<th class="text-center" ng-click="sort=='deskripsi'?reverse=!reverse:null;sort='deskripsi'">
					<strong>Deskripsi </strong>
					<span ng-show="sort=='deskripsi'&&reverse==true" class="glyphicon glyphicon-triangle-bottom"></span>
					<span ng-show="sort=='deskripsi'&&reverse==false" class="glyphicon glyphicon-triangle-top"></span>
				</th>
				<th class="text-center">Pilihan</th>
			</tr>
		</thead>
		<tbody>
			<tr ng-repeat="barang in displayed = (filtered = (barangs | filter:search) | orderBy:sort:reverse | startFrom:(currentPage-1)*itemsPerPage | limitTo:itemsPerPage)">
				<td class="text-center"><input type="checkbox" ng-model="barang.selected" ng-change="uncheckDisplayed(barang.selected)"></td>
				<td ng-bind="::barang.kode"></td>
				<td ng-bind="::barang.kategori"></td>
				<td ng-bind="::barang.nama"></td>
				<td ng-bind="::barang.alias"></td>
				<td ng-bind="::barang.satuan"></td>
				<td><span ng-bind="::barang.deskripsi | limitTo:'40'"></span><span ng-show="barang.deskripsi.length>=40">.....</span></td>
				<td class="text-center">
					<button class="btn btn-default btn-sm" type="button" ng-click="openRead(barang)"><span class="glyphicon glyphicon-search"></span></button>
					<button class="btn btn-default btn-sm" type="button" ng-click="openUpdate(barang)"><span class="glyphicon glyphicon-edit"></span></button>
					<button class="btn btn-default btn-sm" type="button" ng-click="delete(barang)"><span class="glyphicon glyphicon-trash"></span></button>
				</td>
			</tr>
		</tbody>
	</table>
	<div class="form-inline" ng-show="filtered.length>0">
		<span class="pull-left" ng-show="displayed.length>0">
			<span class="input-group input-group-sm" dropdown>
				<span class="input-group-addon">{{selected.length}} Dipilih</span>
				<button type="button" class="form-control btn btn-default dropdown-toggle" ng-disabled="!selected.length" dropdown-toggle>
					<span class="caret"></span>
				</button>
				<ul class="dropdown-menu" role="menu">
					<li><a href ng-click="uncheckAll()">Reset</a></li>
					<li><a href ng-click="deleteSelected()">Hapus</a></li>
				</ul>
			</span>
		</span>
		<span class="pull-right">
			<span ng-show="displayed.length!=0&&currentPageForm.$valid" ng-bind="'Menampilkan '+((currentPage-1)*itemsPerPage+1)+'-'+(currentPage*itemsPerPage)+' dari '+(filtered.length)+' data'"></span>
			<span class="input-group input-group-sm">
				<span class="input-group-btn">
					<button type="button" class="form-control btn btn-default" ng-click="currentPage=1" ng-disabled="currentPageForm.$invalid">
						<span class="glyphicon glyphicon-fast-backward"</span>
					</button>
				</span>
				<span class="input-group-btn">
					<button type="button" class="form-control btn btn-default" ng-click="currentPage=(currentPage-1)" ng-disabled="currentPageForm.$invalid">
						<span class="glyphicon glyphicon-backward"</span>
					</button>
				</span>
				<form name="currentPageForm">
					<input type="number" name="currentPage" class="form-control text-center" min="1" max="{{maxPage}}" ng-max="maxPage" ng-model="currentPage" required/>
				</form>
				<span class="input-group-addon"><strong>dari <span ng-bind="maxPage=(Math.ceil(filtered.length/itemsPerPage))"></span></strong></span>
				<span class="input-group-btn">
					<button type="button" class="form-control btn btn-default" ng-click="currentPage=(currentPage+1)" ng-disabled="currentPageForm.$invalid">
						<span class="glyphicon glyphicon-forward"</span>
					</button>
				</span>
				<span class="input-group-btn">
					<button type="button" class="form-control btn btn-default" ng-click="currentPage=maxPage" ng-disabled="currentPageForm.$invalid">
						<span class="glyphicon glyphicon-fast-forward"</span>
					</button>
				</span>
			</span>
		</span>
	</div>
</div>
